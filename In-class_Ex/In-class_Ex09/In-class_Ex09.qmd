---
title: "In-class-Exercise 9"
author: "Gerald Lim"
execute:
  warning: false
date: "`r Sys.Date()`"
---

## **1 Installing and Loading R packages**

This code chunk performs 3 tasks:

-   A list called packages will be created and will consists of all the R packages required to accomplish this exercise.

-   Check if R packages on package have been installed in R and if not, they will be installed.

-   After all the R packages have been installed, they will be loaded.

```{r}
pacman::p_load(sf, spdep, GWmodel, SpatialML, tmap, rsample, Metrics, tidyverse, rpart, rpart.plot, ggstatsplot, performance)
```

## **14.4 Preparing Data**

### **14.4.1 Reading data file to rds**

Reading the input data sets. It is in simple feature data frame.

```{r}
rs_sf <- read_rds("data/rds/HDB_resale.rds")
```

### **14.4.2 Data Sampling**

The entire data are split into training and test data sets with 65% and 35% respectively by using *initial_split()* of **rsample** package. rsample is one of the package of tigymodels.

```{r}
set.seed(1234) 
resale_split <- initial_split(
  rs_sf,                                
  prop = 5/10,) 
train_sf <- training(resale_split) 
test_sf <- testing(resale_split)
```

```{r}
train_df <- train_sf %>%
  st_drop_geometry() %>%
  as.data.frame()

test_df <- test_sf %>%
  st_drop_geometry() %>%
  as.data.frame()
```

```{r}
#| fig-width: 12
#| fig-height: 12
```

```{r}
train_df <- train_df %>%
  select(-c(PROX_CHAS))
train_sf <- train_sf %>%
  select(-c(PROX_CHAS))
test_df <- test_df %>%
  select(-c(PROX_CHAS))
test_sf <- test_sf %>%
  select(-c(PROX_CHAS))
```

```{r}
#| eval: false
rs_mlr <- lm(formula = RESALE_PRICE ~ floor_area_sqm +
                  storey_order + remaining_lease_mths +
                  PROX_CBD + PROX_ELDERLYCARE + PROX_HAWKER +
                  PROX_MRT + PROX_PARK + PROX_MALL + 
                  PROX_SUPERMARKET + WITHIN_350M_KINDERGARTEN +
                  WITHIN_350M_CHILDCARE + WITHIN_350M_BUS +
                  WITHIN_1KM_PRISCH,
                data=train_data)
summary(price_mlr)
```

```{r}
#| eval: false

train_sp <- as_Spatial()
```
